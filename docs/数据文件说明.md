# æ•°æ®æ–‡ä»¶ç»“æ„è¯´æ˜

## ä¸¤ä¸ªæ–‡ä»¶çš„å…³ç³»

```
response.jsonl (åŸå§‹æ ‡æ³¨æ•°æ®)
        â†“
    [æ•°æ®é¢„å¤„ç†]
        â†“
test_response_label.jsonl (ç®€åŒ–åçš„æµ‹è¯•æ•°æ®)
```

---

## æ–‡ä»¶1: response.jsonl (åŸå§‹æ•°æ®)

### å­—æ®µç»“æ„
```json
{
  "id": "2",
  "source_id": "15592",
  "model": "mistral-7B-instruct",
  "temperature": 0.7,
  "labels": [                           â† è¯¦ç»†çš„æ ‡æ³¨æ•°ç»„
    {
      "start": 636,                     â† å¹»è§‰æ–‡æœ¬çš„èµ·å§‹ä½ç½®
      "end": 653,                       â† å¹»è§‰æ–‡æœ¬çš„ç»“æŸä½ç½®
      "text": "February 7, 2022.",      â† å…·ä½“çš„å¹»è§‰æ–‡æœ¬
      "meta": "EVIDENT CONFLICT...",    â† æ ‡æ³¨è¯´æ˜
      "label_type": "Evident Conflict", â† å¹»è§‰ç±»å‹
      "implicit_true": false,
      "due_to_null": false
    },
    {
      "start": 871,
      "end": 969,
      "text": "has prompted the Anne Frank House...",
      "meta": "HIGH INTRODUCTION OF NEW INFORMATION...",
      "label_type": "Evident Baseless Info",
      ...
    },
    {
      "start": 607,
      "end": 646,
      "text": "believed to have died before February 7",
      "meta": "EVIDENT CONFLICT...",
      "label_type": "Evident Conflict",
      ...
    }
  ],
  "split": "train",
  "quality": "good",
  "response": "New research conducted by..."
}
```

### ç‰¹ç‚¹
- âœ… åŒ…å«å¹»è§‰çš„**ç²¾ç¡®ä½ç½®**ï¼ˆå­—ç¬¦çº§åˆ«ï¼‰
- âœ… åŒ…å«å¹»è§‰çš„**å…·ä½“æ–‡æœ¬**
- âœ… åŒ…å«è¯¦ç»†çš„**æ ‡æ³¨è¯´æ˜**
- âœ… ä¸€ä¸ªå“åº”å¯èƒ½æœ‰**å¤šä¸ªæ ‡æ³¨**ï¼ˆlabelsæ˜¯æ•°ç»„ï¼‰

---

## æ–‡ä»¶2: test_response_label.jsonl (ç®€åŒ–æ•°æ®)

### å­—æ®µç»“æ„
```json
{
  "id": "2",
  "source_id": "15592",
  "task_type": "Summary",
  "test": "Seventy years ago, Anne Frank died...",
  "response": "New research conducted by...",
  "label_types": [                      â† åªä¿ç•™å¹»è§‰ç±»å‹
    "Evident Conflict",
    "Evident Baseless Info",
    "Evident Conflict"
  ]
}
```

### ç‰¹ç‚¹
- âœ… ç®€åŒ–ä¸º**å¹»è§‰æ£€æµ‹**æ‰€éœ€çš„æœ€å°‘ä¿¡æ¯
- âœ… å»æ‰äº†ä½ç½®ã€æ–‡æœ¬ç­‰ç»†èŠ‚
- âœ… å¢åŠ äº† `task_type` å­—æ®µï¼ˆä»»åŠ¡ç±»å‹ï¼‰
- âœ… å¢åŠ äº† `test` å­—æ®µï¼ˆåŸæ–‡/æµ‹è¯•è¾“å…¥ï¼‰

---

## ä¸ºä»€ä¹ˆä¸€ä¸ªæ•°æ®æœ‰å¤šä¸ª label_typeï¼Ÿ

### åŸå› ï¼šä¸€ä¸ªç”Ÿæˆçš„å“åº”å¯èƒ½åŒ…å«å¤šå¤„å¹»è§‰

### å®é™…æ¡ˆä¾‹ï¼ˆID=2ï¼‰

**ç”Ÿæˆçš„å“åº”ï¼ˆ970å­—ç¬¦ï¼‰ä¸­æœ‰3å¤„å¹»è§‰ï¼š**

#### å¹»è§‰1: æ—¥æœŸé”™è¯¯ï¼ˆä½ç½®636-653ï¼‰
```
æ–‡æœ¬: "February 7, 2022."
ç±»å‹: Evident Conflict
è¯´æ˜: åŸæ–‡æ˜¯ 1945å¹´ï¼Œç”Ÿæˆé”™è¯¯å†™æˆ 2022å¹´
```

#### å¹»è§‰2: å‡­ç©ºç¼–é€ ï¼ˆä½ç½®871-969ï¼‰
```
æ–‡æœ¬: "has prompted the Anne Frank House to issue a corrected statement..."
ç±»å‹: Evident Baseless Info
è¯´æ˜: åŸæ–‡ä¸­å®Œå…¨æ²¡æœ‰æåˆ°è¿™ä¸ªä¿¡æ¯
```

#### å¹»è§‰3: æ—¥æœŸæ¨¡ç³Šï¼ˆä½ç½®607-646ï¼‰
```
æ–‡æœ¬: "believed to have died before February 7"
ç±»å‹: Evident Conflict
è¯´æ˜: åŸæ–‡è¯´æ—¥æœŸä¸ç¡®å®šï¼Œç”Ÿæˆå´ç»™å‡ºæ˜ç¡®æ—¥æœŸ
```

**ç»“æœï¼š**
```python
label_types = [
    'Evident Conflict',        # å¯¹åº”å¹»è§‰1
    'Evident Baseless Info',   # å¯¹åº”å¹»è§‰2
    'Evident Conflict'         # å¯¹åº”å¹»è§‰3
]
```

---

## æ•°æ®ç»Ÿè®¡

| ç±»åˆ« | æ•°é‡ | æ¯”ä¾‹ |
|------|------|------|
| **æ€»æ•°æ®é‡** | 17,790 | 100% |
| æ— å¹»è§‰ | 10,126 | 56.9% |
| å•ä¸ªå¹»è§‰ | 4,138 | 23.3% |
| **å¤šä¸ªå¹»è§‰** | **3,526** | **19.8%** |
| æœ€å¤šå¹»è§‰æ•° | 14 | - |

### å…³é”®å‘ç°
- ğŸ“Š **è¿‘20%çš„æœ‰å¹»è§‰æ•°æ®åŒ…å«å¤šå¤„å¹»è§‰**
- ğŸ“Š æœ€æç«¯çš„æ ·æœ¬åŒ…å«**14å¤„å¹»è§‰**
- ğŸ“Š å¹³å‡æ¯ä¸ªæœ‰å¹»è§‰çš„æ ·æœ¬åŒ…å« **1.8ä¸ªå¹»è§‰**

---

## ä¸ºä»€ä¹ˆåœ¨ response.jsonl ä¸­ä½ "æ²¡æœ‰å‘ç°"label_typeï¼Ÿ

### å¯èƒ½çš„åŸå› 

#### 1. æŸ¥çœ‹äº†æ— å¹»è§‰çš„æ•°æ®
```json
{
  "id": "0",
  "labels": [],  â† ç©ºæ•°ç»„ï¼Œæ— å¹»è§‰
  ...
}
```

#### 2. labels æ˜¯æ•°ç»„ï¼Œéœ€è¦å±•å¼€æŸ¥çœ‹
```json
{
  "labels": [
    {
      "label_type": "Evident Conflict",  â† åœ¨è¿™é‡Œï¼
      ...
    }
  ]
}
```

#### 3. æ–‡ä»¶å¤ªé•¿ï¼Œå†…å®¹è¢«æˆªæ–­
- response.jsonl æ¯è¡Œéƒ½å¾ˆé•¿ï¼ˆ2000-4000å­—ç¬¦ï¼‰
- IDEå¯èƒ½æ²¡æœ‰æ˜¾ç¤ºå®Œæ•´çš„JSONç»“æ„

---

## æ•°æ®è½¬æ¢è¿‡ç¨‹ï¼ˆæ¨æµ‹ï¼‰

å¯èƒ½å­˜åœ¨ä¸€ä¸ªé¢„å¤„ç†è„šæœ¬ï¼š

```python
def convert_response_to_test(response_file, test_file):
    """
    å°† response.jsonl è½¬æ¢ä¸º test_response_label.jsonl
    """
    with open(response_file, 'r') as f_in, \
         open(test_file, 'w') as f_out:
        
        for line in f_in:
            data = json.loads(line)
            
            # æå– label_types
            label_types = [
                label['label_type'] 
                for label in data.get('labels', [])
            ]
            
            # æ„å»ºæ–°æ ¼å¼
            new_data = {
                'id': data['id'],
                'source_id': data['source_id'],
                'task_type': infer_task_type(data),  # æ ¹æ®sourceæ¨æ–­
                'test': get_test_content(data),      # è·å–åŸæ–‡
                'response': data['response'],
                'label_types': label_types
            }
            
            f_out.write(json.dumps(new_data) + '\n')
```

---

## ä½¿ç”¨åœºæ™¯

### response.jsonl
- ğŸ“ **æ ‡æ³¨ç ”ç©¶**ï¼šåˆ†æå¹»è§‰çš„å…·ä½“ä½ç½®å’Œå†…å®¹
- ğŸ“ **è´¨é‡è¯„ä¼°**ï¼šæ£€æŸ¥æ ‡æ³¨çš„å‡†ç¡®æ€§
- ğŸ“ **è¯¦ç»†åˆ†æ**ï¼šç†è§£æ¯ä¸ªå¹»è§‰çš„å…·ä½“è¡¨ç°

### test_response_label.jsonl
- ğŸ” **å¹»è§‰æ£€æµ‹**ï¼šè®­ç»ƒ/æµ‹è¯•æ£€æµ‹æ¨¡å‹
- ğŸ” **æ€§èƒ½è¯„ä¼°**ï¼šè®¡ç®—å‡†ç¡®ç‡ã€å¬å›ç‡
- ğŸ” **å¿«é€Ÿç­›é€‰**ï¼šæŒ‰å¹»è§‰ç±»å‹è¿‡æ»¤æ•°æ®

---

## æ€»ç»“

### æ ¸å¿ƒåŒºåˆ«
| ç‰¹æ€§ | response.jsonl | test_response_label.jsonl |
|------|----------------|---------------------------|
| **ç”¨é€”** | æ ‡æ³¨å­˜å‚¨ | æ¨¡å‹æµ‹è¯• |
| **å¹»è§‰ä¿¡æ¯** | è¯¦ç»†ï¼ˆä½ç½®+æ–‡æœ¬+è¯´æ˜ï¼‰ | ç®€åŒ–ï¼ˆåªæœ‰ç±»å‹ï¼‰ |
| **æ–‡ä»¶å¤§å°** | è¾ƒå¤§ | è¾ƒå° |
| **æ˜“è¯»æ€§** | å¤æ‚ | ç®€å• |

### ä¸ºä»€ä¹ˆæœ‰å¤šä¸ªlabel_typeï¼Ÿ
**å› ä¸ºä¸€ä¸ªAIç”Ÿæˆçš„å“åº”å¯èƒ½åœ¨å¤šå¤„å­˜åœ¨ä¸åŒç±»å‹çš„å¹»è§‰ï¼**

è¿™æ˜¯çœŸå®ä¸–ç•Œçš„æƒ…å†µï¼š
- ä¸€ä¸ªå¥å­å¯èƒ½æœ‰äº‹å®é”™è¯¯ï¼ˆConflictï¼‰
- å¦ä¸€ä¸ªå¥å­å¯èƒ½æ˜¯å‡­ç©ºç¼–é€ ï¼ˆBaselessï¼‰
- åŒä¸€ä¸ªå“åº”ä¸­å¯èƒ½åŒæ—¶å­˜åœ¨å¤šç§å¹»è§‰

æ•°æ®é›†å¿ å®è®°å½•äº†è¿™ç§å¤æ‚æ€§ã€‚
