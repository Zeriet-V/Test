# æ£€ç´¢å¢å¼º NLI è‡ªåŠ¨è¿è¡Œå’Œä¸Šä¼ 

## ğŸš€ ä¸€é”®è¿è¡Œï¼ˆæ¨èï¼‰

### æ–¹æ³•1ï¼šPython è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /home/xgq/Test/detectors/nli_methods
python3 run_retrieval_and_upload.py
```

### æ–¹æ³•2ï¼šShell è„šæœ¬

```bash
cd /home/xgq/Test/detectors/nli_methods
bash run_retrieval_and_upload.sh
```

## â±ï¸ è¿è¡Œæ—¶é—´

- **æ£€æµ‹é˜¶æ®µ**: 3-4 å°æ—¶
- **ä¸Šä¼ é˜¶æ®µ**: 1-2 åˆ†é’Ÿ
- **æ€»è€—æ—¶**: çº¦ 3-4 å°æ—¶

## ğŸ“‹ æ‰§è¡Œæµç¨‹

### æ­¥éª¤ 1/3ï¼šè¿è¡Œæ£€ç´¢å¢å¼º NLI æ£€æµ‹

è‡ªåŠ¨æ‰§è¡Œï¼š
```bash
python3 nli_retrieval_detector.py \
  --gpu 1 \
  --input /home/xgq/Test/data/validation_set.jsonl \
  --output nli_retrieval_validation_results.jsonl \
  --use-entailment \
  --sentence-level \
  --threshold-entail 0.45 \
  --threshold-contra 0.2 \
  --top-k 3
```

**è¾“å‡ºæ–‡ä»¶**ï¼š
- `nli_retrieval_validation_results.jsonl` - è¯¦ç»†ç»“æœ
- `nli_retrieval_validation_results_report.txt` - ç»Ÿè®¡æŠ¥å‘Š

### æ­¥éª¤ 2/3ï¼šæ£€æŸ¥ç»“æœæ–‡ä»¶

è‡ªåŠ¨æ£€æŸ¥ï¼š
- âœ“ ç»“æœæ–‡ä»¶æ˜¯å¦ç”Ÿæˆ
- âœ“ æŠ¥å‘Šæ–‡ä»¶æ˜¯å¦ç”Ÿæˆ
- âœ“ æ˜¾ç¤ºæ€§èƒ½æ‘˜è¦ï¼ˆF1/Precision/Recallï¼‰

### æ­¥éª¤ 3/3ï¼šä¸Šä¼ åˆ° GitHub

è‡ªåŠ¨æ‰§è¡Œï¼š
```bash
cd /home/xgq/Test

# æ·»åŠ æ–‡ä»¶
git add detectors/nli_methods/nli_retrieval_validation_results.jsonl
git add detectors/nli_methods/nli_retrieval_validation_results_report.txt
git add detectors/nli_methods/nli_retrieval_detector.py
git add detectors/nli_methods/æ£€ç´¢å¢å¼ºNLIä½¿ç”¨è¯´æ˜.md
git add docs/BARTScore_NLI_ç»¼åˆæŠ¥å‘Š.md

# æäº¤
git commit -m "æ·»åŠ æ£€ç´¢å¢å¼ºNLIéªŒè¯é›†ç»“æœ - Top-K=3"

# æ¨é€
git push
```

## ğŸ“¥ æœ¬åœ°æŸ¥çœ‹ç»“æœ

è¿è¡Œå®Œæˆå¹¶ä¸Šä¼ åï¼Œåœ¨ä½ çš„æœ¬åœ°ç”µè„‘ï¼š

```bash
cd /path/to/your/local/Test

# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# æŸ¥çœ‹æŠ¥å‘Š
cat detectors/nli_methods/nli_retrieval_validation_results_report.txt

# æˆ–åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€
code detectors/nli_methods/nli_retrieval_validation_results_report.txt
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç¡®ä¿ Git é…ç½®æ­£ç¡®

é¦–æ¬¡ä½¿ç”¨å‰ï¼Œç¡®ä¿ï¼š
```bash
cd /home/xgq/Test
git config user.name "Your Name"
git config user.email "your.email@example.com"
```

### 2. å¦‚æœæ¨é€å¤±è´¥

è„šæœ¬ä¼šæç¤ºæ¨é€å¤±è´¥ï¼Œä½ éœ€è¦æ‰‹åŠ¨æ‰§è¡Œï¼š
```bash
cd /home/xgq/Test
git push origin main  # æˆ– master
```

å¯èƒ½çš„åŸå› ï¼š
- éœ€è¦è®¤è¯ï¼ˆGitHub tokenï¼‰
- è¿œç¨‹ä»“åº“æœ‰æ›´æ–°ï¼ˆéœ€è¦å…ˆ pullï¼‰
- ç½‘ç»œé—®é¢˜

### 3. åå°è¿è¡Œï¼ˆæ¨èï¼‰

å¦‚æœæƒ³åœ¨åå°è¿è¡Œå¹¶è®°å½•æ—¥å¿—ï¼š

```bash
cd /home/xgq/Test/detectors/nli_methods

# åå°è¿è¡Œï¼Œè¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶
nohup python3 run_retrieval_and_upload.py > retrieval_run.log 2>&1 &

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep run_retrieval_and_upload

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f retrieval_run.log

# æŸ¥çœ‹ GPU ä½¿ç”¨æƒ…å†µ
watch -n 1 nvidia-smi
```

## ğŸ“Š è¿è¡Œå®Œæˆå

### è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶

1. **nli_retrieval_validation_results.jsonl** - æ¯ä¸ªæ ·æœ¬çš„è¯¦ç»†ç»“æœ
2. **nli_retrieval_validation_results_report.txt** - ç»Ÿè®¡æŠ¥å‘Šï¼ˆæ ¼å¼ä¸æ ‡å‡† NLI ç›¸åŒï¼‰

### å¯¹æ¯”åˆ†æ

è¿è¡Œå®Œæˆåï¼Œå¯ä»¥å¯¹æ¯”ï¼š

| æ–¹æ³• | æŠ¥å‘Šæ–‡ä»¶ | F1 | Precision | Recall |
|------|---------|-----|-----------|---------|
| æ ‡å‡† NLI | `nli_validation_fixed_cpu_report.txt` | 62.06 | 45.70% | 96.67% |
| æ£€ç´¢å¢å¼º NLI | `nli_retrieval_validation_results_report.txt` | ? | ? | ? |

æŸ¥çœ‹æ£€ç´¢å¢å¼ºæ˜¯å¦å¸¦æ¥æ€§èƒ½æå‡ï¼

## ğŸ”§ æ•…éšœæ’æŸ¥

### å¦‚æœæ£€æµ‹é˜¶æ®µå¤±è´¥

```bash
# æ£€æŸ¥é”™è¯¯æ—¥å¿—
cat retrieval_run.log

# æ‰‹åŠ¨è¿è¡Œæ£€æµ‹
python3 nli_retrieval_detector.py --gpu 1 \
  --input /home/xgq/Test/data/validation_set.jsonl \
  --output nli_retrieval_validation_results.jsonl
```

### å¦‚æœä¸Šä¼ é˜¶æ®µå¤±è´¥

```bash
cd /home/xgq/Test

# æ‰‹åŠ¨ä¸Šä¼ 
git add detectors/nli_methods/nli_retrieval_validation_results*
git commit -m "æ·»åŠ æ£€ç´¢å¢å¼ºNLIç»“æœ"
git push
```

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **åå°è¿è¡Œ**ï¼šç”¨ `nohup` åå°è¿è¡Œï¼Œé¿å…ç»ˆç«¯æ–­å¼€å¯¼è‡´ä¸­æ–­
2. **ç›‘æ§è¿›åº¦**ï¼šç”¨ `tail -f retrieval_run.log` å®æ—¶æŸ¥çœ‹è¿›åº¦
3. **æ£€æŸ¥ GPU**ï¼šç”¨ `nvidia-smi` ç¡®è®¤ GPU 1 åœ¨è¿è¡Œ
4. **é¢„ç•™æ—¶é—´**ï¼šè‡³å°‘é¢„ç•™ 4-5 å°æ—¶

